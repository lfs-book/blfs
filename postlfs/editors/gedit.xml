<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY gedit-dependencies-download-http "See below">
  <!ENTITY gedit-dependencies-download-ftp  " ">
  <!ENTITY gedit-download-http "&gnome-download-http;/gedit/&gedit-major-version;/">
  <!ENTITY gedit-download-ftp  " ">
  <!ENTITY gedit-size          "4.2 MB">
  <!ENTITY gedit-buildsize     "112 MB (with tests)">
  <!ENTITY gedit-time          "0.3 SBU (using parallelism=4; with tests)">

  <!ENTITY libgedit-amtk-version          "5.9.1">
  <!ENTITY libgedit-amtk-md5sum           "8559a3e694f4e06b7f320d7f29562ef0">

  <!ENTITY libgedit-gtksourceview-version "299.5.0">
  <!ENTITY libgedit-gtksourceview-md5sum  "bb16dc84f8fb5acf05eb3c19f00f7724">

  <!ENTITY libgedit-gfls-version          "0.3.0">
  <!ENTITY libgedit-gfls-md5sum           "763a7260ef1f139ea2a314a34080610e">

  <!ENTITY libgedit-tepl-version          "6.13.0">
  <!ENTITY libgedit-tepl-md5sum           "9d96b099416064e20b37fec855c00faf">

  <!ENTITY gedit-md5sum                   "1aa72a59d51be4597490220af3ad0421">
]>

<sect1 id="gedit" xreflabel="Gedit-&gedit-version;">
  <?dbhtml filename="gedit.html"?>

  <title>Gedit-&gedit-version;</title>

  <indexterm zone="gedit">
    <primary sortas="a-Gedit">Gedit</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction to Gedit</title>

    <para>
      The <application>Gedit</application> package contains a lightweight
      UTF-8 text editor for the <application>GNOME</application> Desktop. It
      needs a group of packages to be installed before
      <application>Gedit</application> itself. This page will install all of
      them.
    </para>

    &lfs123_checked;

    <bridgehead renderas="sect3">Package Information</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Download (HTTP): <ulink url="&gedit-dependencies-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Download (FTP): <ulink url="&gedit-dependencies-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Download size: &gedit-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimated disk space required: &gedit-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimated build time: &gedit-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Gedit Dependencies</bridgehead>

    <bridgehead renderas="sect4">Required</bridgehead>
    <para role="required">
      <!--<xref linkend="git"/>, unneeded -->
      <xref linkend="gsettings-desktop-schemas"/>,
      <xref linkend="gtk3"/>,
      <xref linkend="itstool"/>,
      <xref linkend="libhandy1"/>,
      <xref linkend="libpeas"/>, and
      <xref linkend="libxml2"/>
    </para>

    <bridgehead renderas="sect4">Recommended</bridgehead>
    <para role="recommended">
      <xref linkend="gspell"/>,
      <xref role="runtime" linkend="gvfs"/> (runtime),
      <xref linkend="iso-codes"/>, and
      <xref linkend="pygobject3"/> (<application>Python3</application> module)
    </para>

    <bridgehead renderas="sect4">Optional</bridgehead>
    <para role="optional">
      <xref linkend="gtk-doc"/> (for documentation),
      <xref linkend="vala"/>,
      <xref linkend="valgrind"/>, and
      <ulink url="https://launchpad.net/zeitgeist">zeitgeist</ulink>
    </para>

  </sect2>

  <sect2>
    <title>Downloading Gedit</title>

    <para>
      You will need to download all of <application>Gedit's</application>
      dependencies and the main package itself. Create lists of files to be
      downloaded. The files will also be used to verify the integrity of the
      downloads when complete:
    </para>

<screen><userinput>cat &gt; gedit-dependencies-&gedit-version;.md5 &lt;&lt; "EOF"
<literal>&libgedit-amtk-md5sum;  libgedit-amtk/-/archive/&libgedit-amtk-version;/libgedit-amtk-&libgedit-amtk-version;.tar.bz2
&libgedit-gtksourceview-md5sum;  libgedit-gtksourceview/-/archive/&libgedit-gtksourceview-version;/libgedit-gtksourceview-&libgedit-gtksourceview-version;.tar.bz2
&libgedit-gfls-md5sum;  libgedit-gfls/-/archive/&libgedit-gfls-version;/libgedit-gfls-&libgedit-gfls-version;.tar.bz2
&libgedit-tepl-md5sum;  libgedit-tepl/-/archive/&libgedit-tepl-version;/libgedit-tepl-&libgedit-tepl-version;.tar.bz2</literal>
EOF

cat &gt; gedit-&gedit-version;.md5 &lt;&lt; "EOF"
<literal>&gedit-md5sum;  gedit-&gedit-version;.tar.xz</literal>
EOF</userinput></screen>

    <para>
      To download the needed files using <xref linkend='wget'/>,
      use the following commands:
    </para>

<screen><userinput>mkdir gedit-pkgs &amp;&amp;
cd    gedit-pkgs &amp;&amp;

grep -v '^#' ../gedit-dependencies-&gedit-version;.md5 | awk '{print $2}' | wget -i- -c \
     -B https://gitlab.gnome.org/World/gedit/ &amp;&amp;

grep -v '^#' ../gedit-&gedit-version;.md5 | awk '{print $2}' | wget -i- -c \
     -B &gedit-download-http; &amp;&amp;

while read -r md5 file; do
    package=$(basename "$file")
    echo "$md5  $package"
done &lt; ../gedit-dependencies-&gedit-version;.md5 | md5sum -c &amp;&amp;

md5sum -c ../gedit-&gedit-version;.md5</userinput></screen>

  </sect2>

  <sect2 role="installation">
    <title>Installation of Gedit</title>

    &as_root;

    <para>
      All of the packages come with a test suite. If you wish to execute them,
      either comment out the <command>rm -rf ...</command> below, so that,
      after all the packages are installed, you can come back to the
      corresponding directory and run <command>ninja test</command>, or do
      individual builds, running the tests for each of the packages.
      Alternatively, you can uncomment the line #<command>ninja test
      ...</command>, and at the end, check the test results with:
    </para>

<screen><userinput>grep -A9 summary *ninja_test.log</userinput></screen>

    <para>
      <application>Libgedit-amtk's</application> test-action-map test is known
      to fail.
    </para>

    <para>
      First, start a subshell that will exit on error:
    </para>

<screen><userinput>bash -e</userinput></screen>

    <para>
      Install <application>Gedit</application> and its dependencies by running
      the following commands:
    </para>

<screen><userinput>for package in $(grep -v '^#' ../gedit{-dependencies,}-&gedit-version;.md5 | awk '{print $2}')
do
  package=$(basename "$package")
  packagedir=${package%.tar.?z*}

  echo "Building $packagedir"
    tar -xf $package
    pushd $packagedir
      cd build

      meson setup ..            \
            --prefix=/usr       \
            --buildtype=release \
            -D gtk_doc=false 
      ninja

      #ninja test 2>&amp;1 | tee ../../$packagedir-ninja_test.log
  
      as_root ninja install
    popd

  rm -rf $packagedir
  as_root /sbin/ldconfig
done</userinput></screen>

    <para>
      Finally, exit the shell that was started earlier:
    </para>

<screen><userinput>exit</userinput></screen>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/gsettings-destdir.xml"/>

  </sect2>

  <sect2 role="commands">
    <title>Command Explanations</title>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/meson-buildtype-release.xml"/>

    <para>
      <parameter>-D gtk_doc=false</parameter>: This switch disables
      generating the API documentation. Omit this switch if you have
      <xref linkend="gtk-doc"/> installed and wish to generate the API
      documentation.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Installed Program</segtitle>
      <segtitle>Installed Libraries</segtitle>
      <segtitle>Installed Directories</segtitle>

      <seglistitem>
        <seg>
          gedit
        </seg>
        <seg>
          libgedit-48.so,
          libgedit-amtk-5.so,
          libgedit-gfls-1.so,
          libgedit-gtksourceview-300.so, and
          libgedit-tepl-6.so
        </seg>
        <seg>
          /usr/include/gedit-48,
          /usr/include/libgedit-amtk-5,
          /usr/include/libgedit-gfls-1,
          /usr/include/libgedit-gtksourceview-300,
          /usr/include/libgedit-tepl-6,
          /usr/share/gtk-doc/html/libgedit-amtk-5.0,
          /usr/share/libgedit-gtksourceview-300, and
          /usr/{lib,share,share/help/*}/gedit
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Short Descriptions</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="gedit-prog">
        <term><command>gedit</command></term>
        <listitem>
          <para>
            is a lightweight text editor integrated with the
            <application>GNOME</application> Desktop
          </para>
          <indexterm zone="gedit gedit-prog">
            <primary sortas="b-gedit">gedit</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgedit-48">
        <term><filename class="libraryfile">libgedit-48.so</filename></term>
        <listitem>
          <para>
            contains all the functions used by the main
            <application>Gedit</application> application
          </para>
          <indexterm zone="gedit libgedit-48">
            <primary sortas="c-libgedit-48">libgedit-48.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgedit-amtk-5">
        <term><filename class="libraryfile">libgedit-amtk-5.so</filename></term>
        <listitem>
          <para>
            provides a basic GTKUIManager replacement API based on GAction
          </para>
          <indexterm zone="gedit libgedit-amtk-5">
            <primary sortas="c-libgedit-amtk-5">libgedit-amtk-5.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgedit-gfls-1">
        <term><filename class="libraryfile">libgedit-gfls-1.so</filename></term>
        <listitem>
          <para>
            provides functions for loading and saving files
          </para>
          <indexterm zone="gedit libgedit-gfls-1">
            <primary sortas="c-libgedit-gfls-1">libgedit-gfls-1.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgedit-gtksourceview-300">
        <term><filename class="libraryfile">
           libgedit-gtksourceview-300.so</filename></term>
        <listitem>
          <para>
            contains convenience functions for text editing
          </para>
          <indexterm zone="gedit libgedit-gtksourceview-300">
            <primary sortas="c-liblibgedit-gtksourceview-300">
              liblibgedit-gtksourceview-300.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgedit-tepl-6">
        <term><filename class="libraryfile">libgedit-tepl-6.so</filename></term>
        <listitem>
          <para>
            is a text editor framework for <application>GTK</application> text
            editors and IDEs
          </para>
          <indexterm zone="gedit libgedit-tepl-6">
            <primary sortas="c-libgedit-tepl-6">libgedit-tepl-6.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
